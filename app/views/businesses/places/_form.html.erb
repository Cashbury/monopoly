<%= javascript_include_tag 'prototype' %>
<%= calendar_date_select_includes %>
<% CalendarDateSelect.format=(:iso_date)%>

<script type="text/javascript">
 jQuery(document).ready(function(){
   
   jQuery('select#place_address_attributes_country_id').bind('change',function(){
    var country_id = jQuery(":selected", this).val();
    jQuery.getScript("/businesses/update_cities/"+country_id+"?selector_id=place_address_attributes_city_id");
  });
  
  jQuery('#add_new_item_button').click(function(){
    jQuery('#add_new_item_fieldset').toggle();
  });
  
});
</script>

<%= form_for([@business,@place],:html => { :multipart => true }) do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </p>
  <p>
    <%= f.label :long %><br />
    <%= f.text_field :long %>
  </p>
  <p>
    <%= f.label :lat %><br />
    <%= f.text_field :lat %>
  </p>
  <p>
    <%= f.label :description %><br />
    <%= f.text_area :description %>
  </p>
  <p>
    <%= f.label :time_zone %><br />
    <%= f.time_zone_select :time_zone, ActiveSupport::TimeZone.all%>
  </p>
  <p>
    <%= f.label 'Keywords' %><br />
    <%= f.text_field :tag_list %>
    <small>Optional, comma separated</small>
  </p>
  <fieldset>
    <legend>Place Images</legend>
    <p>
      <%if ENABLE_DELAYED_UPLOADS%>
        <% f.fields_for :place_images do |pimage| %>
            <%= pimage.label(:delete_photo, 'Delete photo') %>
            <%= image_tag(pimage.object.photo.url(:thumb), :alt => 'Photo', :title => 'Current photo') %>
            <%= pimage.check_box(:delete_photo) %><br />
        <%end%>
        <% f.fields_for :tmp_images do |pimage| %>
          <%= pimage.label(:photo, 'Upload photo') %>
          <%= pimage.file_field(:photo) %><br />
        <%end%>
      <%else%>
        <% f.fields_for :place_images do |pimage| %>
          <%- unless pimage.object.new_record?-%>
            <%= pimage.label(:delete_photo, 'Delete photo') %>
            <%= image_tag(pimage.object.photo.url(:thumb), :alt => 'Photo', :title => 'Current photo') %>
            <%= pimage.check_box(:delete_photo) %><br />
          <%- else -%>
            <br />
            <%= pimage.label(:photo, 'Upload photo') %>
            <%= pimage.file_field(:photo) %><br />
          <%- end -%>
        <%end%>
      <%end%>
    </p>
  </fieldset>
   <br />
  <fieldset>
    <legend>Place Address</legend>
    <p>
      <%= f.fields_for :address, f.object.address do |address_form| %>
        <p>
          <%= address_form.label :street_address %>
          <%= address_form.text_field :street_address %>
        </p>
        <p>
          <%= address_form.label :neighborhood %>
          <%= address_form.text_field :neighborhood %>
        </p>
        <p>
          <%= address_form.label :country %>
          <%= address_form.select :country_id, "<option value=''>..Select Country..</option>".html_safe + options_from_collection_for_select(Country.all , :id, :name,address_form.object.country_id)%>
        </p>
        <p>
          <%= address_form.label :city %>
          <%= address_form.select :city_id, "<option value=''>..Select City..</option>".html_safe + options_from_collection_for_select(City.all, :id, :name,address_form.object.city_id)%>
        </p>
         <p>
          <%= address_form.label :zipcode %>
          <%= address_form.text_field :zipcode %>
        </p> 
      <%end%>
    </p>
  </fieldset>
  <br />
  <fieldset>
    <legend>Hours of operations?</legend>
    <p>Mon</p>
    <select name="data[PlaceOphour][hour01]" class="othertime" id="PlaceOphourHour01">
        <option value="00:00">12:00 AM</option>
        <option value="00:30">12:30 AM</option>
        <option value="01:00">1:00 AM</option>
        <option value="01:30">1:30 AM</option>
        <option value="02:00">2:00 AM</option>
        <option value="02:30">2:30 AM</option>
        <option value="03:00">3:00 AM</option>
        <option value="03:30">3:30 AM</option>
        <option value="04:00">4:00 AM</option>
        <option value="04:30">4:30 AM</option>
        <option value="05:00">5:00 AM</option>
        <option value="05:30">5:30 AM</option>
        <option value="06:00">6:00 AM</option>
        <option value="06:30">6:30 AM</option>
        <option value="07:00">7:00 AM</option>
        <option value="07:30">7:30 AM</option>
        <option value="08:00">8:00 AM</option>
        <option value="08:30">8:30 AM</option>
        <option value="09:00">9:00 AM</option>
        <option value="09:30">9:30 AM</option>
        <option value="10:00">10:00 AM</option>
        <option value="10:30">10:30 AM</option>
        <option value="11:00">11:00 AM</option>
        <option value="11:30">11:30 AM</option><option value="12:00">12:00 PM</option><option value="12:30">12:30 PM</option><option value="13:00">1:00 PM</option><option value="13:30">1:30 PM</option><option value="14:00">2:00 PM</option><option value="14:30">2:30 PM</option><option value="15:00">3:00 PM</option><option value="15:30">3:30 PM</option><option value="16:00">4:00 PM</option><option value="16:30">4:30 PM</option><option value="17:00">5:00 PM</option><option value="17:30">5:30 PM</option><option value="18:00">6:00 PM</option><option value="18:30">6:30 PM</option><option value="19:00">7:00 PM</option><option value="19:30">7:30 PM</option><option value="20:00">8:00 PM</option><option value="20:30">8:30 PM</option><option value="21:00">9:00 PM</option><option value="21:30">9:30 PM</option><option value="22:00">10:00 PM</option><option value="22:30">10:30 PM</option><option value="23:00">11:00 PM</option><option value="23:30">11:30 PM</option>
    </select>
    <select name="data[PlaceOphour][hour02]" class="othertime" id="PlaceOphourHour02">
      <option value="00:00">12:00 AM</option>
      <option value="00:30">12:30 AM</option>
      <option value="01:00">1:00 AM</option>
      <option value="01:30">1:30 AM</option>
      <option value="02:00">2:00 AM</option>
      <option value="02:30">2:30 AM</option>
      <option value="03:00">3:00 AM</option>
      <option value="03:30">3:30 AM</option>
      <option value="04:00">4:00 AM</option>
      <option value="04:30">4:30 AM</option>
      <option value="05:00">5:00 AM</option>
      <option value="05:30">5:30 AM</option>
      <option value="06:00">6:00 AM</option>
      <option value="06:30">6:30 AM</option>
      <option value="07:00">7:00 AM</option>
      <option value="07:30">7:30 AM</option>
      <option value="08:00">8:00 AM</option>
      <option value="08:30">8:30 AM</option>
      <option value="09:00">9:00 AM</option>
      <option value="09:30">9:30 AM</option>
      <option value="10:00">10:00 AM</option>
      <option value="10:30">10:30 AM</option>
      <option value="11:00">11:00 AM</option>
      <option value="11:30">11:30 AM</option>
      <option value="12:00">12:00 PM</option>
      <option value="12:30">12:30 PM</option>
      <option value="13:00">1:00 PM</option>
      <option value="13:30">1:30 PM</option>
      <option value="14:00">2:00 PM</option>
      <option value="14:30">2:30 PM</option>
      <option value="15:00">3:00 PM</option>
      <option value="15:30">3:30 PM</option>
      <option value="16:00">4:00 PM</option>
      <option value="16:30">4:30 PM</option>
      <option value="17:00">5:00 PM</option>
      <option value="17:30">5:30 PM</option>
      <option value="18:00">6:00 PM</option>
      <option value="18:30">6:30 PM</option>
      <option value="19:00">7:00 PM</option>
      <option value="19:30">7:30 PM</option>
      <option value="20:00">8:00 PM</option>
      <option value="20:30">8:30 PM</option>
      <option value="21:00">9:00 PM</option>
      <option value="21:30">9:30 PM</option>
      <option value="22:00">10:00 PM</option>
      <option value="22:30">10:30 PM</option>
      <option value="23:00">11:00 PM</option>
      <option value="23:30">11:30 PM</option>
  </select>
  </fieldset>
  <br />

  <fieldset>
    <legend>Assign Items to Place</legend>
    <p>
      <%= f.label :items, "Items" %><br />
      <% @items.each do |item| %>
      <%= check_box_tag(
                        "place[items_list][#{item.id}]", 
                        "1", 
                        @place.items.detect{|i| i.id == item.id}) %>
       <%= "#{item.name}"%><br />
      <% end %>
    </p>
  </fieldset>
  <input type="button" value="Add New Item"  id="add_new_item_button"/>
  <fieldset id="add_new_item_fieldset" style="display:none">
    <legend>Add New Item to Place</legend>
    <p>
        <p>
           <%= label_tag "name" %><br />
           <%= text_field_tag "item[name]"  %>
        </p>
        <p>
           <%= label_tag "description" %><br />
           <%= text_field_tag "item[description]"  %>
        </p>
        <p>
           <%= label_tag "price" %><br />
           <%= text_field_tag "item[price]"  %>
        </p>
        <p>
           <%= label_tag "available" %><br />
           <%= select_tag "item[available]", options_for_select([ ['yes', 'true'],['no','false']])%>
        </p>
        <p>
           <%= label_tag "expiry_date" %>
           <%= calendar_date_select_tag "item[expiry_date]" %>
         </p>
         <p>
           <%= label_tag "cost" %><br />
           <%= text_field_tag "item[cost]"  %>
        </p>
        <p>
           <%= label_tag "product_code" %><br />
           <%= text_field_tag "item[product_code]"  %>
        </p>
        
    </p>
  </fieldset>
  
  <p><%= f.submit %></p>
<% end %>
